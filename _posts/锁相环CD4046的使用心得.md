---
title: 锁相环CD4046使用心得
date: 2024-11-23 22:10:42
index_img: https://s21.ax1x.com/2025/05/27/pVpC14f.png
categories: 电子设计
math: true
---

![成品](https://i.imgur.com/ZpUo6qu.jpg)

# 前言
最近在忙着做校队招新的题目，要求是用锁相环CD4046B做一个倍频器，倍频系数为1，2，4，8，16，32，64。这个题最烦人的地方在于覆盖的频率范围很大，输入信号范围是1kHz~100kHz，这样来算输出最大要达到6.4MHz，然而以CD4046B来说这根本不可能，因为这款锁相环上集成的VCO的输出频率最大也就1MHz左右：

![](https://i.imgur.com/51pBwa3.png)

如你所见，输出最大频率的典型值为**1.4MHz**，这也基本符合我实测的结果。总之这题做满100kHz的64倍频基本是没戏了，但是听说有个组做到了7MHz？搞不懂是什么情况。（再吐槽一句，TI的CD4046B的数据手册真的太古老了啊，赶紧更新一下吧）

# 引脚说明

![](https://i.imgur.com/Z91APjn.png)

见上图。

- 3；鉴相器输入
- 4：VCO输出
- 6、7之间的$C_1$是VCO的起振电容
- 12脚$R_2$决定了输出频率是否叠加一个偏置。如果不接，那么输出无偏置，频率就可以达到比较低的范围；如果接上电阻，频率范围整体会往上移动。
- 11脚$R_1$也影响了输出频率·范围，R1越小输出频率越大，我这里取的是10k欧。
- 5脚禁止端，低电平使能器件。
- 13，鉴相器2的输出，它接入环路滤波器的输入端。
- 9，VCO的输入，这个输入电压应当尽可能平稳，这样VCO才会有稳定的输出。

我这次在调试电路过程中动的最多的就是C1和引脚，4。通过调整C1的值来获得不同的频率输出范围；将3、4直接连接来测试锁相环的功能；确定锁相环能正常工作后再把3、4断开，接入分频器。

# 频率范围

CD4046B的输出频率与供电电压有关，供电电压越大，能够输出的频率也越大，但是不能超过15V。根据我的测试，在5V供电，R2不接，R1=10k欧，C1=100pF的情况下，VCO的输出频率最多只有大约700kHZ。想达到1MHz以上的频率必须增大电压到10V，但是这又会产生一问题：锁相环是10V电平输入输出，而分频器是5V电平，两种电平并不互容，必须进行**电平转换**。这是我们组在昨天得到的结论，然后今天我自己花了半个上午的时间才总算是调好了。为了能够覆盖从1kHz~1MHz的频率范围，我切换了三个电容：

| 100pF | 4.7nF | 3.3nF |
|-------|-------|-------|
| 41k~1.2M | 2k~40k | 1k~29k |

注意这里的频率应当是**倍频后最终输出的频率**。

# 电平转换

这里的电平转换，具体来说：

- 锁相环VCO输出的10V方波要被转换为5V方波
- 分频器输出的5V方波要被转换为10V方波

LTspice仿真结果如下：

![](https://i.imgur.com/3vQpjKX.png)

高电平转低电平用的是左边那个电路，其实就是一个反相器。需要注意的是上拉电阻R1不要取得太大，不然上升沿过于缓慢，适应不了1MHz。而且这个电路实际测试的时候输出在下降沿的振铃非常大，大概是杂散电容和寄生电感的影响（毕竟是焊接到洞洞板上的）。

低电平转高电平用的是右边的电路，因为左边的电路这时候就不能用了。

# 环路滤波器

这是锁相环相当重要的一环。环路滤波器的职责就是将鉴相器输出的高频分量尽可能地滤干净。网上关于环路滤波器的设计方法资料并不是很多，可以参见该博客：[锁相环学习---CD4046](https://www.cnblogs.com/qm1412/p/18222379)

环路滤波器有专用的设计软件，但是非常古老，必须再下载一个XP系统的虚拟机，非常麻烦，所以我就直接使用博客里设计好的电路了：

![](https://i.imgur.com/yCQpeqy.jpg)

LTspice仿真得到其幅频响应和相频响应如下：

![](https://i.imgur.com/LWBPZIo.png)

实测这个滤波器可以用于1kHz~1MHz的范围。

# 对VCO输出进行整形

这一步其实并不是必要的，但是我还是使用告诉比较器把输出波形整成好看一点的方波，这主要是因为我所用的10V转5V的电平转换电路上升沿非常慢，以至于方波几乎已经变成锯齿波了，非常难受。

![](https://i.imgur.com/NrkVsnV.png)

注意我最终电路中VIN是经过电容之后才送入比较器，这样隔离直流分量，比较器容易产生正确的结果。另外R1可以稍微取得大一些，比如500欧，对噪声的抑制能力也会强一些。这个比较器的输出为3.3V、0V，可以直接送入单片机的外部时钟输入引脚用来测量频率。

# 总结

最后实现的效果如图（输入信号与输出信号稳定同频显示不漂移）只拍了N=1的情况，N=64也能非常稳

![](https://i.imgur.com/PvEWWA3.jpg)

这次与锁相环有关的电路基本都是我负责的，焊接在一大块洞洞板上，焊锡丝的助焊剂快熏死我了。。。不过好在最后的成品表现非常不错，最大能锁定到1.2MHz的频率，已经接近CD4046B的极限了。另外队友也买了一大堆CD4046B，过几天我想用这些多余的芯片测试一下锁相环的FM解调功能。